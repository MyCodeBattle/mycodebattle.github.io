---
categories: Posts
date: 2014-08-26 00:00:00
title: HDU 1166 - 敌兵布阵
tags: []
layout: post
---

## 传送门

[HDU 1166 - 敌兵布阵](http://www.bnuoj.com/v3/problem_show.php?pid=5379)

## 思路

和上一题一样，只不过维护的变成了区间的和

## 代码


```c++
#include <cstdio>
#include <cstring>
#include <algorithm>
#include <map>
#include <queue>
#include <cctype>
#define MP(a, b) make_pair(a, b)
using namespace std;
const int MAXN = 50000 + 5;
const int INF = 0x3f3f3f3f;
 
struct SEG
{
    int l, r, sum;
}segt[MAXN << 2];
 
char buf[10];
 
void PushUp(int cur)
{
    segt[cur].sum = segt[cur << 1].sum + segt[cur << 1 | 1].sum;
}
 
void Build(int cur, int l, int r)
{
    segt[cur].l = l, segt[cur].r = r;
    if (l == r)
    {
        segt[cur].sum = ReadInt();
        return;
    }
    int mid = l + ((r - l) >> 1);
    Build(cur << 1, l, mid);
    Build(cur << 1 | 1, mid + 1, r);
    PushUp(cur);
}
 
int Query(int cur, int l, int r)
{
    int ans;
    if (segt[cur].l == l && segt[cur].r == r)
        return segt[cur].sum;
    int mid = segt[cur].l + ((segt[cur].r - segt[cur].l) >> 1);
    if (r <= mid)
        ans = Query(cur << 1, l, r);
    else if (l > mid)
        ans = Query(cur << 1 | 1, l, r);
    else
    {
        ans = Query(cur << 1, l, mid);
        ans += Query(cur << 1 | 1, mid + 1, r);
    }
    return ans;
}
 
void Update(int cur, int pos, int val)
{
    if (segt[cur].l == segt[cur].r)
    {
        segt[cur].sum += strcmp(buf, "Add") == 0 ? val : -val;
        return;
    }
    int mid = segt[cur].l + ((segt[cur].r - segt[cur].l) >> 1);
    if (pos <= mid)
        Update(cur << 1, pos, val);
    else
        Update(cur << 1 | 1, pos, val);
    PushUp(cur);
}
 
int main()
{
    //freopen("input.txt", "r", stdin);
    int T, i, j, ncamp, a, b, cases = 0;
    scanf("%d", &T);
    while (T--)
    {
        scanf("%d", &ncamp);
        Build(1, 1, ncamp);
        printf("Case %d:\n", ++cases);
        while (scanf("%s", buf), strcmp(buf, "End") != 0)
        {
            scanf("%d%d", &a, &b);
            if (!strcmp(buf, "Query"))
                printf("%d\n", Query(1, a, b));
            else if (!strcmp(buf, "Add"))
                Update(1, a, b);
            else
                Update(1, a, b);
        }
    }
    return 0;
}
```